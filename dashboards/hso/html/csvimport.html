<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read CSV File</title>
<style>
.line{
	display:flex;
	flex-direction: row;
}
.value{
	margin-right: 5px;
	background: red;
	width: 150px;
}

.value:first-child{
	width:200px;
}

</style>
</head>
<body>
	<input type="file" id="fileInput" accept=".csv" />
	<pre id="output"></pre>

	<script>
	    document.getElementById('fileInput').addEventListener('change', function(event) {
	        const file = event.target.files[0];
	        if (file) {
	            const reader = new FileReader();
	            reader.onload = function(e) {
	                processData(e.target.result);
	            };
	            reader.readAsText(file);
	        }
	    });
        
    	//TODO: Add date compare: new Data(text)

		async function processData(allText) {
	    	var allTextLines = allText.split("\n");
	    	var headers = allTextLines[0].split("\t");
	    	var lines = [];
	    	let include = [];
	    	let outputElement = document.getElementById("output");
	    	let lineDiv = document.createElement("div");
	        lineDiv.className = "line";
	        outputElement.appendChild(lineDiv);
	    	for(let i = 0; i < headers.length; i++){
	    		headers[i] = headers[i].replaceAll("\t");
	    		let incl = i == 0? true : headers[i] == null? false : headers[i].startsWith("WS000278");
	    		include[i] = incl;
	    		
	    		if(incl){
	    		let valueDiv = document.createElement("div");
	            			valueDiv.className = "value";
	            			valueDiv.innerHTML = headers[i];
	            			lineDiv.appendChild(valueDiv);
	    		}
	    	}
			for(let i=1; i<allTextLines.length; i++) {
	       		var data = allTextLines[i].split('\t');
	        	if (data.length == headers.length) {
	
	            	let lineDiv = document.createElement("div");
	            	lineDiv.className = "line";
	            	
	            	for (let j=0; j<headers.length; j++) {
	            		if(include[j]){	  
	            			let valueDiv = document.createElement("div");
	            			valueDiv.className = "value";
	            			valueDiv.innerHTML = data[j];
	            			lineDiv.appendChild(valueDiv);
	            	    }
	            	}
	            	
	            	outputElement.appendChild(lineDiv);       	
	        	}
	    	}
	    
		}
    </script>
</body>
</html>